<h1 style="text-align:center"> RSA中公开的模数N
 实验报告</h1>

<h4 style="text-align:center">学号：SA20225172  姓名：郭俊勇</h4>

## 实验目的

- 了解公钥加密方案的一般结构 
- 深入理解RSA加密原语的密钥生成 
- 编程实现对没有正确生成密钥的RSA的破解，提醒大家不要尝试自己随意实现加密原语

## 编程语言

- Java

## 实验内容

![image-20210423184820306](C:\Users\Brian\AppData\Roaming\Typora\typora-user-images\image-20210423184820306.png)

![image-20210423184903624](C:\Users\Brian\AppData\Roaming\Typora\typora-user-images\image-20210423184903624.png)

## 实验原理分析

- 任务一：   

  
  $$
  |p-q|<2N^{1/4}=>(p-q)^2<4\sqrt{N} \\
  =>(p+q)^2-4pq<4\sqrt{N}\\
  =>(\frac{(p+q)}{2})^2-pq<\sqrt{N}\\
  因为A=\frac{(p+q)}{2}  N=pq 带入上式\\
  =>A^2-N<\sqrt{N}=>A-\sqrt{N}<\frac{\sqrt{N}}{A+\sqrt{N}}
  \\又因为A>\sqrt{N}
  \\因此A-\sqrt{N}<\frac{1}{2}
  \\可推出0<A-\sqrt{N}<1
  $$
  
- 任务二：
  $$
  |p-q|<2^{11}\sqrt{N}=>(p-q)^2<2^{22}\sqrt{N}
  \\=>(p+q)^2-4pq<2^{22}\sqrt{N}\\
  =>(\frac{(p+q)}{2})^2-pq<2^{20}\sqrt{N}\\
  因为A=\frac{(p+q)}{2}  N=pq 带入上式\\
  =>A^2-N<\sqrt{N}=>A-\sqrt{N}<2^{20}\frac{\sqrt{N}}{A+\sqrt{N}}<2^{19}\\
  因此\sqrt{N}<A<\sqrt{N}+2^{19}
  $$
  

## Java代码实现（源码）

```java
public class lab4 {
    public static void main(String[] args) {
        task_1();
        System.out.println();
        task_2();
    }

    private static void task_2() {
        String s="648455842808071669662824265346772278726343720706976263060439070378797308618081116462714015276061417569195587321840254520655424906719892428844841839353281972988531310511738648965962582821502504990264452100885281673303711142296421027840289307657458645233683357077834689715838646088239640236866252211790085787877";
        BigInteger num=new BigInteger(s);
        BigInteger rem=new BigInteger("1");
        BigInteger a= Sqrt(num).add(rem);
        //num.sqrt();
        while(true){
            BigInteger ans=a.multiply(a);
            BigInteger ans2=ans.subtract(num);
            BigInteger x=Sqrt(ans2);
            BigInteger p=a.subtract(x);
            BigInteger q=a.add(x);
            if(p.multiply(q).equals(num)){
                System.out.println("task2 Success!!");
                System.out.println("task2-p:"+p);
                System.out.println("task2-q:"+q);
                break;
            }else {
                BigInteger temp=new BigInteger("72077");
                a=a.add(temp);
            }
        }

    }

    private static void task_1() {
        String s="179769313486231590772930519078902473361797697894230657273430081157732675805505620686985379449212982959585501387537164015710139858647833778606925583497541085196591615128057575940752635007475935288710823649949940771895617054361149474865046711015101563940680527540071584560878577663743040086340742855278549092581";
        BigInteger num =new BigInteger(s);
        BigInteger rem=new BigInteger("1");
        //开方
        BigInteger a = Sqrt(num).add(rem);
        //a*a
        BigInteger ans=a.multiply(a);
        //a*a-N
        BigInteger ans2=ans.subtract(num);
        //对a*a-N开方获取x
        BigInteger x=Sqrt(ans2);
        //p=a-x
        BigInteger p=a.subtract(x);
        //q=a+x
        BigInteger q=a.add(x);
        if(p.multiply(q).equals(num)){
            System.out.println("task1 Success!!!!");
            System.out.println("task1-p:"+p);
            System.out.println("task1-q:"+q);
        }else{
            System.out.println("Failed!");
        }
    }

    public static BigInteger Sqrt(BigInteger x){
        BigInteger l = new BigInteger("0"), r = new BigInteger(x.toString());
        BigInteger ans = new BigInteger("-1");
        while(l.compareTo(r) <= 0){
            BigInteger mid = r.add(l).divide(new BigInteger("2"));
            if(mid.multiply(mid).compareTo(x) <= 0){
                ans = mid;
                l = mid.add(new BigInteger("1"));
            }else{
                r = mid.subtract(new BigInteger("1"));
            }
        }
        return ans;
    }
}
```

## 运行结果

![image-20210423191801673](C:\Users\Brian\AppData\Roaming\Typora\typora-user-images\image-20210423191801673.png)